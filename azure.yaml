# ============================================================================
# Azure Developer CLI (azd) Configuration
# Usage: azd up
# ============================================================================
name: autonomous-network-noc
metadata:
  template: autonomous-network-noc@0.0.1
hooks:
  preprovision:
    shell: sh
    run: hooks/preprovision.sh
    description: Resolve signed-in user principal ID
  postprovision:
    shell: sh
    run: hooks/postprovision.sh
    description: Populate azure_config.env with deployment outputs

# Single unified service â€” FastAPI serves API + static frontend
# Deployed to Azure App Service (Web App)
services:
  api:
    project: ./api
    language: python
    host: appservice
    hooks:
      prepackage:
        shell: sh
        run: |
          cd ../frontend && npm ci && npm run build
          rm -rf ../api/static && cp -r dist ../api/static/
        description: Build frontend and copy to api/static/
